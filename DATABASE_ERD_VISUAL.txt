BOOKTY E-COMMERCE - VISUAL ERD GUIDE
=====================================

This file provides a text-based visual representation of the database ERD.
You can use this to recreate the diagram in tools like:
- draw.io (diagrams.net)
- Lucidchart
- dbdiagram.io
- MySQL Workbench
- Visual Paradigm

=====================================
ENTITY POSITIONING GUIDE
=====================================

TOP ROW (User & Authentication):
[users] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

SECOND ROW (Product Catalog):
[genres] â”€â”€â†’ [books] â†â”€â”€ [tropes]
              â†“
         [book_trope] (pivot)

THIRD ROW (Shopping):
[carts] â”€â”€â†’ [cart_items] â”€â”€â†’ [books]
[orders] â”€â”€â†’ [order_items] â”€â”€â†’ [books]
[wishlists] â”€â”€â†’ [books] â†â”€â”€ [users]

FOURTH ROW (Promotions):
[coupons] â”€â”€â†’ [coupon_usages] â”€â”€â†’ [orders]
[book_discounts] â”€â”€â†’ [books]
[flash_sales] â”€â”€â†’ [flash_sale_items] â”€â”€â†’ [books]

FIFTH ROW (Reviews):
[reviews] â†â”€â”€ [users]
[reviews] â†â”€â”€ [books]
[reviews] â†â”€â”€ [order_items]
[reviews] â”€â”€â†’ [review_helpfuls] â†â”€â”€ [users]
[reviews] â”€â”€â†’ [review_reports] â†â”€â”€ [users]

BOTTOM ROW (System):
[postage_rates] (standalone, referenced by orders)
[settings] (standalone)

=====================================
RELATIONSHIP DETAILS
=====================================

USERS
â”œâ”€â”€ hasMany â†’ orders (user_id)
â”œâ”€â”€ hasOne â†’ carts (user_id)
â”œâ”€â”€ hasMany â†’ reviews (user_id)
â”œâ”€â”€ hasMany â†’ wishlists (user_id)
â”œâ”€â”€ hasMany â†’ review_helpfuls (user_id)
â”œâ”€â”€ hasMany â†’ review_reports (user_id, as reporter)
â”œâ”€â”€ hasMany â†’ review_reports (admin_id, as reviewer)
â””â”€â”€ hasMany â†’ coupon_usages (user_id)

GENRES
â””â”€â”€ hasMany â†’ books (genre_id)

TROPES
â””â”€â”€ belongsToMany â†’ books (via book_trope pivot)

BOOKS
â”œâ”€â”€ belongsTo â†’ genres (genre_id)
â”œâ”€â”€ belongsToMany â†’ tropes (via book_trope)
â”œâ”€â”€ hasMany â†’ cart_items (book_id)
â”œâ”€â”€ hasMany â†’ order_items (book_id)
â”œâ”€â”€ hasMany â†’ reviews (book_id)
â”œâ”€â”€ hasMany â†’ wishlists (book_id)
â”œâ”€â”€ hasOne â†’ book_discounts (book_id)
â””â”€â”€ belongsToMany â†’ flash_sales (via flash_sale_items)

CARTS
â”œâ”€â”€ belongsTo â†’ users (user_id)
â””â”€â”€ hasMany â†’ cart_items (cart_id)

CART_ITEMS
â”œâ”€â”€ belongsTo â†’ carts (cart_id)
â””â”€â”€ belongsTo â†’ books (book_id)

ORDERS
â”œâ”€â”€ belongsTo â†’ users (user_id)
â”œâ”€â”€ hasMany â†’ order_items (order_id)
â”œâ”€â”€ belongsTo â†’ coupons (coupon_id, nullable)
â””â”€â”€ hasMany â†’ coupon_usages (order_id)

ORDER_ITEMS
â”œâ”€â”€ belongsTo â†’ orders (order_id)
â”œâ”€â”€ belongsTo â†’ books (book_id)
â””â”€â”€ hasOne â†’ reviews (order_item_id, nullable)

WISHLISTS
â”œâ”€â”€ belongsTo â†’ users (user_id)
â””â”€â”€ belongsTo â†’ books (book_id)
Unique: (user_id, book_id)

COUPONS
â”œâ”€â”€ hasMany â†’ orders (coupon_id)
â””â”€â”€ hasMany â†’ coupon_usages (coupon_id)

COUPON_USAGES
â”œâ”€â”€ belongsTo â†’ coupons (coupon_id)
â”œâ”€â”€ belongsTo â†’ users (user_id)
â””â”€â”€ belongsTo â†’ orders (order_id)

BOOK_DISCOUNTS
â””â”€â”€ belongsTo â†’ books (book_id)

FLASH_SALES
â””â”€â”€ hasMany â†’ flash_sale_items (flash_sale_id)

FLASH_SALE_ITEMS
â”œâ”€â”€ belongsTo â†’ flash_sales (flash_sale_id)
â””â”€â”€ belongsTo â†’ books (book_id)
Unique: (flash_sale_id, book_id)

REVIEWS
â”œâ”€â”€ belongsTo â†’ users (user_id)
â”œâ”€â”€ belongsTo â†’ books (book_id)
â”œâ”€â”€ belongsTo â†’ order_items (order_item_id, nullable)
â”œâ”€â”€ hasMany â†’ review_helpfuls (review_id)
â””â”€â”€ hasMany â†’ review_reports (review_id)

REVIEW_HELPFULS
â”œâ”€â”€ belongsTo â†’ reviews (review_id)
â””â”€â”€ belongsTo â†’ users (user_id)

REVIEW_REPORTS
â”œâ”€â”€ belongsTo â†’ reviews (review_id)
â”œâ”€â”€ belongsTo â†’ users (user_id, as reporter)
â””â”€â”€ belongsTo â†’ users (admin_id, as reviewer, nullable)

POSTAGE_RATES
â””â”€â”€ (No direct relationship - values denormalized into orders)

SETTINGS
â””â”€â”€ (Standalone configuration table)

=====================================
COLOR CODING SUGGESTION
=====================================

For visual diagrams, use these colors:

ğŸ”µ BLUE - Core Entities
   - users, genres, tropes, books

ğŸŸ¢ GREEN - Shopping Entities
   - carts, cart_items, orders, order_items, wishlists

ğŸŸ¡ YELLOW - Promotion Entities
   - coupons, coupon_usages, book_discounts, flash_sales, flash_sale_items

ğŸŸ£ PURPLE - Review Entities
   - reviews, review_helpfuls, review_reports

âšª GRAY - System Entities
   - postage_rates, settings

ğŸŸ  ORANGE - Pivot Tables
   - book_trope, flash_sale_items (also acts as pivot)

=====================================
KEY ATTRIBUTES TO DISPLAY
=====================================

USERS
- id (PK)
- name, email
- phone_number, address fields

GENRES
- id (PK)
- name, slug

TROPES
- id (PK)
- name, slug

BOOKS
- id (PK)
- title, author, price, stock
- genre_id (FK)

CARTS
- id (PK)
- user_id (FK, unique)

CART_ITEMS
- id (PK)
- cart_id (FK)
- book_id (FK)
- quantity

ORDERS
- id (PK)
- user_id (FK)
- public_id (unique)
- total_amount
- status, payment_status
- shipping fields
- coupon_id (FK, nullable)

ORDER_ITEMS
- id (PK)
- order_id (FK)
- book_id (FK)
- quantity, price, cost_price
- total_selling, total_cost

WISHLISTS
- id (PK)
- user_id (FK)
- book_id (FK)
- Unique: (user_id, book_id)

COUPONS
- id (PK)
- code (unique)
- discount_type, discount_value
- starts_at, expires_at
- is_active

COUPON_USAGES
- id (PK)
- coupon_id (FK)
- user_id (FK)
- order_id (FK)
- discount_amount

BOOK_DISCOUNTS
- id (PK)
- book_id (FK, unique)
- discount_amount, discount_percent
- starts_at, ends_at
- is_active

FLASH_SALES
- id (PK)
- name
- starts_at, ends_at
- discount_type, discount_value
- is_active

FLASH_SALE_ITEMS
- id (PK)
- flash_sale_id (FK)
- book_id (FK)
- special_price
- Unique: (flash_sale_id, book_id)

REVIEWS
- id (PK)
- user_id (FK)
- book_id (FK)
- order_item_id (FK, nullable, unique)
- rating, comment
- images (json)
- is_approved

REVIEW_HELPFULS
- id (PK)
- review_id (FK)
- user_id (FK)

REVIEW_REPORTS
- id (PK)
- review_id (FK)
- user_id (FK, reporter)
- admin_id (FK, nullable, reviewer)
- reason, status

POSTAGE_RATES
- id (PK)
- region (enum)
- customer_price
- actual_cost

SETTINGS
- id (PK)
- key (unique)
- value
- group

=====================================
NOTES FOR DIAGRAM CREATION
=====================================

1. Use CROWS FOOT notation:
   - ||--o{ = One-to-Many
   - ||--o| = One-to-One
   - }o--o{ = Many-to-Many

2. Show Foreign Keys:
   - Draw lines from child to parent
   - Label with FK name

3. Show Unique Constraints:
   - Mark with (U) or unique icon
   - Important: wishlists, book_trope, flash_sale_items

4. Show Optional Relationships:
   - Use dashed lines for nullable FKs
   - Examples: orders.coupon_id, reviews.order_item_id

5. Denormalization Notes:
   - Add note near orders: "Shipping prices denormalized from postage_rates"
   - Add note near order_items: "Prices denormalized from books"

6. Cascade Delete:
   - Mark with (C) or cascade icon
   - Examples: cart_items, order_items, wishlists

=====================================
SIMPLIFIED GROUPING
=====================================

GROUP 1: User & Authentication
â”œâ”€â”€ users
â””â”€â”€ (Spatie Permissions tables - not shown in detail)

GROUP 2: Product Catalog
â”œâ”€â”€ genres
â”œâ”€â”€ tropes
â”œâ”€â”€ books
â””â”€â”€ book_trope (pivot)

GROUP 3: Shopping
â”œâ”€â”€ carts
â”œâ”€â”€ cart_items
â”œâ”€â”€ orders
â”œâ”€â”€ order_items
â””â”€â”€ wishlists

GROUP 4: Promotions
â”œâ”€â”€ coupons
â”œâ”€â”€ coupon_usages
â”œâ”€â”€ book_discounts
â”œâ”€â”€ flash_sales
â””â”€â”€ flash_sale_items

GROUP 5: Reviews
â”œâ”€â”€ reviews
â”œâ”€â”€ review_helpfuls
â””â”€â”€ review_reports

GROUP 6: System
â”œâ”€â”€ postage_rates
â””â”€â”€ settings

=====================================
END OF VISUAL GUIDE
=====================================

